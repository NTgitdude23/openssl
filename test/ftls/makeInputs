#!/bin/sh

EXT=${EXT:-afl}
FTLS="./ftls-$EXT $@"
export LD_LIBRARY_PATH=../../

$FTLS -o inputs -p normal
for x in 1 2 3 4 ; do # TLS/SSL methods
  $FTLS -c $x -o inputs -p s0c${x}         # each against 0
  $FTLS -s $x -o inputs -p s${x}c0
  $FTLS -s $x -c $x -o inputs -p s${x}c${x}    # each against self

  # each with different cert types
  for y in 1 2 ; do
    $FTLS -s $x -c $x -C $y -o inputs -p s${x}c${x}_cert${y}
  done
done

for x in 5 6 7 ; do # dtls methods
   $FTLS -s $x -c $x -o inputs -p dtls_s${x}c${x} # each against itself
done

# force each kex type
$FTLS -k 1 -o inputs -p kRSA           # 1
$FTLS -k 2 -C 4 -o inputs -p kDHR      # 2
$FTLS -k 3 -C 5 -o inputs -p kDHd      # 4
$FTLS -k 4 -o inputs -p kDHE           # 8
# -k5 is a duplicate (8), skipping!
$FTLS -k 6 -C 6 -o inputs -p kECDHr    # 20
$FTLS -k 7 -C 2 -o inputs -p kECDHe    # 40
$FTLS -k 8 -e 1 -o inputs -p kECDHE    # 80
$FTLS -k 9 -o inputs -p kPSK           # 100
# 10 kGOST
$FTLS -k 11 -o inputs -p kSRP          # 400
$FTLS -k 12 -o inputs -p kRSAPSK       # 800
$FTLS -k 13 -e 1 -o inputs -p kECDHEPSK # 1000
$FTLS -k 14 -C 1 -o inputs -p kDHEPSK  # 2000


# force each cipher type
$FTLS -k 32 -o inputs -p DES          # 1
$FTLS -k 33 -o inputs -p 3DES         # 2
$FTLS -k 34 -o inputs -p RC4          # 4
#$FTLS -k 35 -o inputs -p RC2          # 8
$FTLS -k 36 -o inputs -p IDEA         # 10
$FTLS -k 37 -o inputs -p NULL         # 20
$FTLS -c 1 -k 38 -o inputs -p AES128       # 40
$FTLS -c 1 -k 39 -o inputs -p AES256       # 80
$FTLS -k 40 -o inputs -p CAMELLIA128  # 100
$FTLS -k 41 -o inputs -p CAMELLIA256  # 200
#$FTLS -k 42 -o inputs -p eGOST2814789CNT   # 400
$FTLS -k 43 -o inputs -p SEED         # 800
$FTLS -k 44 -o inputs -p AES128GCM    # 1000
$FTLS -k 45 -o inputs -p AES256GCM    # 2000
$FTLS -k 46 -o inputs -p AES128CCM    # 4000
$FTLS -k 47 -o inputs -p AES256CCM    # 8000
$FTLS -k 38 -o inputs -p AES128CCM8   # 10000
$FTLS -k 39 -o inputs -p AES256CCM8   # 20000

# auth types not being generated by earlier cases
$FTLS -k 64 -C2 -e 1 -o inputs -p aECDSA   # 40
#$FTLS -k 65 -o inputs -p aGOST       # 200
$FTLS -k 66 -o inputs -p aSRP         # 400

# XXX compression
# XXX export ciphers (and temp rsa keys)
# XXX client certs (and using client cert for dh params)
# XXX suiteb
# XXX session resumption
# XXX GOST
# XXX nextproto
# XXX v2 record for client hello
# XXX statem-srvr.c SSL_kRSA in construct_server_key_exchange?
# XXX EVP_CIPH_CBC_MODE in ssl3_record.c tls1_mac ?
# XXX block alignment in rec_layer_s3.c ssl3_write_bytes
# XXX tlsexts: ocsp, hostname, srtp profiles, padding, alpn
# XXX hearbeats

echo generated with $FTLS
